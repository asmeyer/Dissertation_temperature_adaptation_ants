summary(ind.phylo)
summary(ind.clim)
55+1.4
area2=a[2]+a[3]
a[2]+a[3]
a
a
nc.2
?draw.pairwise.venn
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],cex=.5)
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],cex=.1)
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2])
nc.2
a[1]+a[2]
a[2]+a[3]
cross.area=a[2]
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],category=c("Phylogeny","Climate"),lty=rep("blank",2),fill=c("lightblue","red"),alpha=(rep(.6,2)))
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],category=c("Phylogeny","Climate"),lty=rep("blank",2),fill=c("lightblue","red"),alpha=(rep(.6,2)))
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("lightblue","red"),alpha=(rep(.4,2)))
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("lightblue","red"),alpha=(rep(.9,2)))
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("lightblue","red"),alpha=(rep(.2,2)))
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.2,2)))
?draw.pairwise.venn
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.2,2)),cat.dist=rep(0.025,2))
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.2,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0))
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.2,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0))
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0))
?draw.pairwise.venn
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),cex=0)
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),cex=0)
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),cat.prompts=F)
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),ext.text=F)
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),ext.text=F)
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),ext.text=F)
grid.newpage()
draw.pairwise.venn(area1=a[1]+a[2],area2=a[2]+a[3],cross.area=a[2],lty=rep("blank",2),fill=c("blue","red"),alpha=(rep(.4,2)),cat.dist=rep(0.025,2),cat.pos=c(0,0),ext.text=F,cex=0)
nc.2
biplot(aph.pcoa)#biplot of first 2 axes
aph.pcoa$values[1,1]/sum(aph.pcoa$values[,1])# double checking
biplot(aph.pcoa)#biplot of first 2 axes
dat<-read.csv("2014_sampling_data_sheet.csv")#sampling data
tree<-read.tree("Phylogenetics/20150828_raxml_commongarden_NO_BS.nex")#phylogeny with branch lengths only
#removing a few tips for plotting purposes
tree1<-drop.tip(tree,tip=c("PB17-14","PB17-10","PB07-23","PMBE","ALA5","LVA2"))
tree2<-root(tree1,node=105,resolve.root=TRUE)
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
dat<-read.csv("2014_sampling_data_sheet.csv")#sampling data
tree<-read.tree("Phylogenetics/20150828_raxml_commongarden_NO_BS.nex")#phylogeny with branch lengths only
#removing a few tips for plotting purposes
tree1<-drop.tip(tree,tip=c("PB17-14","PB17-10","PB07-23","PMBE","ALA5","LVA2"))
tree2<-root(tree1,node=105,resolve.root=TRUE)
plot(tree2)
##kk, I really want a distance matrix for the ingroup, so I need to get rid of pogos
final.tree<-drop.tip(tree,tip=c("EXIT65","SAL13-14","PMBE","ALA5","LVA2","PB17-14","PB17-10","PB07-23"))
plot(final.tree)
##kk, do pcoa and add to original dataset
dist.mat<-cophenetic.phylo(final.tree)
knitr::kable(head(dist.mat[1:4,1:6]))
aph.pcoa<-pcoa(dist.mat)
knitr::kable(aph.pcoa$values)#eigenvalues
#axis 1 = 44%
#axis2 = 23 %
aph.pcoa$values[1,1]/sum(aph.pcoa$values[,1])# double checking
biplot(aph.pcoa)#biplot of first 2 axes
biplot(aph.pcoa)#biplot of first 2 axes
biplot(aph.pcoa,ylim=c(-.15,.12))#biplot of first 2 axes
biplot(aph.pcoa,ylim=c(-.15,.12))#biplot of first 2 axes
biplot(aph.pcoa,ylim=c(-.15,.12))#biplot of first 2 axes
biplot(aph.pcoa,ylim=c(-.3,-.1))
plot(sub.pcoa[,1],sub.pcoa[,2])
plot(sub.pcoa[,1],sub.pcoa[,2])
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n')
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n',ylim=c(.01,.1),xlim=c(-0.05,.5))
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n',ylim=c(.01,.1),xlim=c(-0.05,.05))
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n',ylim=c(.01,.1),xlim=c(0,.05))
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n')
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n',ylim=c(-.1,0),xlim=c(-.25,-.2))
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
plot(sub.pcoa[,1],sub.pcoa[,2],type='n')
text(sub.pcoa[,1],sub.pcoa[,2],labels=sub.pcoa$Sample)
showvarparts(nc.2)
showvarparts(nc.2$indfract[1:3,3])
?showvarparts
showvarparts(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,~Comp.1+Comp.2+habitat,data=mergy2)
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
nc.2<-varpart(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,~Comp.1+Comp.2+habitat,data=mergy2);nc.2
all<-rda(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,~Comp.1+Comp.2+habitat,data=mergy2)
?rda
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6)+Comp.1+Comp.2+habitat,data=mergy2)
rda.clim<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Condition(Comp.1+Comp.2+habitat),data=mergy2)
rda.frac.phylo<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,data=mergy2)
rda.frac.clim<-rda(mergy2$KO_temp_worker~Comp.1+Comp.2+habitat,data=mergy2)
RsquareAdj(all)
anova(rda.frac.phylo)
anova(rda.frac.clim)
anova(rda.clim)
anova(rda.phylo)
anova(all)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6)+Comp.1+Comp.2+habitat,data=mergy2);summary(rda.phylo)
anova(rda.phylo)
nc.2
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
summary(rda.phylo)
anova(rda.phylo)
test<-varpart(mergy2$KO_temp_worker,~Axis.1,~Comp.1+Comp.2+habitat,data=mergy2)
summary(test)
test
plot(test)
summary(clim)# first 2 pcs epxlain 90% of variation
knitr::kable(clim$loadings[,1:2])
clim<-princomp(scale(cbind(mergy[,99:105],mergy[,110:113])))
summary(clim)# first 2 pcs epxlain 90% of variation
clim
summary(clim)
write.csv(clim$loadings[,1:2],"20150903_anbe_common_garden.csv")
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
```
names(mergy2)
summary(clim)# first 2 pcs epxlain 90% of variation
mergy2
clim
summary(clim)
knitr::kable(clim$loadings[,1:4])
96.45-91.35
98.64-96.45
mergy2<-as.data.frame(cbind(mergy,clim$scores[,1:4]))
names(mergy2)
knitr::kable(aph.pcoa$values)#eigenvalues
biplot(aph.pcoa,ylim=c(-.15,.12))#biplot of first 2 axes
phylo.axis.mod<-lm(KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Axis.7+Axis.8+Axis.9+Axis.10,data=mergy2)
hist(phylo.axis.mod$resids)
hist(phylo.axis.mod$residuals)
phylo.axis.mod<-lm(KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Axis.7+Axis.8+Axis.9+Axis.10+Axis.11,data=mergy2)
hist(phylo.axis.mod$residuals)
phylo.axis.mod<-lm(KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Axis.7+Axis.8+Axis.9+Axis.10,data=mergy2)
hist(phylo.axis.mod$residuals)
?stepAIC
summary(stepAIC(phylo.axis,direction="forward"))
summary(stepAIC(phylo.axis.mod,direction="forward"))
summary(stepAIC(phylo.axis.mod,direction="backward"))
backsel.mod<-varpart(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.6+Axis.7,~Comp.1+Comp.2+habitat,data=mergy2)
backsel.mod
plot(backsel.mod)
clim.axis.mod<-lm(KO_temp_worker~Comp.1+Comp.2+Comp.3+Comp.4,data=mergy2)
clim.axis.mod<-lm(KO_temp_worker~Comp.1+Comp.2+Comp.3+Comp.4,data=mergy2)
summary(stepAIC(clim.axis.mod,direction="forward"))
summary(stepAIC(clim.axis.mod,direction="backward"))
backsel.mod<-varpart(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.6+Axis.7,~Comp.1+Comp.3+habitat,data=mergy2)
backsel.mod
plot(backsel.mod)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1)+Comp.1+Comp.2+habitat,data=mergy2)
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
anova(all)
summary(all)
rda.clim<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Condition(Comp.1+Comp.2+habitat),data=mergy2)
summary(rda.clim)
rda.frac.phylo<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,data=mergy2)
summary(rda.frac.phylo)
rda.frac.clim<-rda(mergy2$KO_temp_worker~Comp.1+Comp.2+habitat,data=mergy2)
rda.frac.clim
full<-lm(KO_temp_worker~bio5*Axis.1+bio5*Axis.2+bio5*Axis.3+bio5*Axis.4,data=mergy2)
mod3<-stepAIC(full,direction="forward")
summary(mod3)
summary(stepAIC(full,direction="backward"))
plot(aph.pcoa$vectors[,1],aph.pcoa$vectors[,3],col=match$color,pch=16,xlim=c(-.3,.2),ylim=c(-.15,.12),xlab="Axis 1",ylab="Axis 2")
plot(aph.pcoa$vectors[,1],aph.pcoa$vectors[,3],col=match$color,pch=16,xlim=c(-.3,.2),ylim=c(-.15,.12),xlab="Axis 1",ylab="Axis 3")
summary(stepAIC(phylo.axis.mod,direction="backward"))
phylo.axis.mod<-lm(KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Axis.7+Axis.8+Axis.9+Axis.10+Axis.11+Axis.12+Axis.13+Axis.14+Axis.15,data=mergy2)
hist(phylo.axis.mod$residuals)
summary(stepAIC(phylo.axis.mod,direction="forward"))
summary(stepAIC(phylo.axis.mod,direction="backward"))
summary(stepAIC(full,direction="backward"))
full<-lm(KO_temp_worker~bio5*Axis.1+bio5*Axis.2+bio5*Axis.3+bio5*Axis.4+Axis.5+Axis.6+Axis.7,data=mergy2)
mod3<-stepAIC(full,direction="forward")
summary(mod3)
summary(stepAIC(full,direction="backward"))
plot(sub.pcoa[,1],sub.pcoa[,3],type='n')
text(sub.pcoa[,1],sub.pcoa[,3],labels=sub.pcoa$Sample)
full.p<-lm(KO_temp_worker~Comp.1*Axis.1+Comp.1*Axis.2+Comp.1*Axis.3+Comp.1*Axis.4,data=mergy2)
mod2<-stepAIC(full.p,direction="forward")
summary(mod2)
full<-lm(KO_temp_worker~bio5*Axis.1+bio5*Axis.2+bio5*Axis.3+bio5*Axis.4+bio5*Axis.5+bio5*Axis.6+bio5*Axis.7,data=mergy2)
mod3<-stepAIC(full,direction="forward")
summary(mod3)
summary(stepAIC(full,direction="backward"))
full.p<-lm(KO_temp_worker~Comp.1*Axis.1+Comp.1*Axis.2+Comp.1*Axis.3+Comp.1*Axis.4+Comp.1*Axis.5,data=mergy2)
mod2<-stepAIC(full.p,direction="forward")
summary(mod2)
summary(stepAIC(full.p,direction="backward"))
mm<-lm(KO_temp_worker~Comp.1*Axis.1+Comp.1*Axis.2+Comp.2*Axis.1+Comp.2*Axis.2,data=mergy2)
mod10<-stepAIC(mm,direction="forward")
summary(mod10)
dim(mergy2)
dim(sub.pcoa)
plot(mergy2$bio5,sub.pcoa[,3],type='n')
text(mergy2$bio5,sub.pcoa[,3],labels=sub.pcoa$Sample)
summary(stepAIC(full.p,direction="backward"))
summary(stepAIC(full,direction="backward"))
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
```
phylosig(new.tree,new.data$KO_temp_worker.x,method="K")
#lambda
phylosig(new.tree,new.data$KO_temp_worker.x,method="lambda")
factorial(x){
return(x)
factorial<-function(x){
return(x)
}
factorial
factorial<-function(x*2){
return(x)
}
factorial<-function(x){
y*2
return(y)
}
factorial
factorial(x)
factorial(2)
factorial<-function(x){
y=x*2
return(y)
}
factorial(10)
factorial
fac<-function(x){
y=x
return(y)
}
load(base)
load(Base)
dist.mat<-cophenetic.phylo(final.tree)
dist.mat
str(dist.mat)
dist.mat
rowNames(dist.mat)
rownames(dist.mat)
colnames(dist.mat)
phylo.axis.mod<-lm(KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Axis.7+Axis.8+Axis.9+Axis.10+Axis.11+Axis.12+Axis.13+Axis.14+Axis.15,data=mergy2)
hist(phylo.axis.mod$residuals)
summary(stepAIC(phylo.axis.mod,direction="forward"))
summary(stepAIC(phylo.axis.mod,direction="backward"))
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
anova(all)
rda.clim<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Condition(Comp.1+Comp.2+habitat),data=mergy2)
anova(rda.clim)
rda.frac.phylo<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,data=mergy2)
anova(rda.frac.phylo)
rda.frac.clim<-rda(mergy2$KO_temp_worker~Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.frac.clim)
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
anova(all)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1+Axis.2)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1)+Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.phylo)
all<-rda(mergy2$KO_temp_worker~Axis.1+Comp.1+Comp.2+habitat,data=mergy2)
anova(all)
rda.clim<-rda(mergy2$KO_temp_worker~Axis.1+Condition(Comp.1+Comp.2+habitat),data=mergy2)
anova(rda.clim)
rda.frac.phylo<-rda(mergy2$KO_temp_worker~Axis.1,data=mergy2)
anova(rda.frac.phylo)
rda.frac.clim<-rda(mergy2$KO_temp_worker~Comp.1+Comp.2+habitat,data=mergy2)
anova(rda.frac.clim)
nc.2<-varpart(mergy2$KO_temp_worker,~Axis.1,~Comp.1+Comp.2+habitat,data=mergy2)
nc.2
plot(nc.2)
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
library(vegan)
all<-rda(mergy2$KO_temp_worker~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6+Comp.1+Comp.2+habitat,data=mergy2)
anova(all)
all
summary(all)
rda.phylo<-rda(mergy2$KO_temp_worker~Condition(Axis.1)+Comp.1+Comp.2+habitat,data=mergy2)
summary(rda.phylo)
plot(rda.phylo)
plot(all)
nc.2<-varpart(mergy2$KO_temp_worker,~Axis.1+Axis.2+Axis.3+Axis.4+Axis.5+Axis.6,~Comp.1+Comp.2+habitat,data=mergy2)
nc.2
plot(nc.2)
dat
names(dat)
subset(dat,dat$species=="rudis" & dat$species=="picea")
subset(dat,dat$species=="rudis")
subset(dat,dat$species=="picea")
rbind(subset(dat,dat$species=="picea"),subset(dat,dat$species=="rudis")
)
write.csv(rbind(subset(dat,dat$species=="picea"),subset(dat,dat$species=="rudis")),"20150915_picea_rudis_data_ANBE.csv")
names(mergy2)
write.csv(rbind(subset(mergy2,mergy2$species=="picea"),subset(mergy2,mergy2$species=="rudis")),"20150915_picea_rudis_data_ANBE.csv")
new.data
names(new.data)
reg<-aov(KO_temp_worker.x~habitat.x,data=new.data)
summary(reg)
jj<-read.csv("Phylogenetics//RAxML_distances.20150828_commongarden_pairwise_ML_distance.csv")
as.dist(xtabs(jj[,3]~jj[,2]+jj[,1]))
str(jj)
head(jj)
jj<-read.csv("Phylogenetics//RAxML_distances.20150828_commongarden_pairwise_ML_distance.csv")
str(jj)
jj<-read.csv("Phylogenetics//RAxML_distances.20150828_commongarden_pairwise_ML_distance.csv",header=F)
str(jj)
as.dist(xtabs(jj[,3]~jj[,2]+jj[,1]))
head(as.dist(xtabs(jj[,3]~jj[,2]+jj[,1])))
dfr<-reshape(jj,direction="wide",idvar="V2",timevar="V1")
dfr
pcoa(dfr)
library(ape)
pcoa(dfr)
write.csv(dfr,"dfr.csv")
t(dfr)
write.csv(t(dfr),"dfr_transposed.csv")
phylosig(new.tree,new.data$KO_temp_worker.x,method="K")
library(lattice)
library(permute)
library(vegan)
library(MASS)
library(sp)
library(rgdal)
library(dismo)
library(maptools)
library(foreign)
library(grid)
library(lattice)
library(maps)
library(ape)
#library(leaps)
library(QuantPsyc)
library(ggplot2)
library(MuMIn)
library(plyr)
library(dplyr)
library(mvSLOUCH)
options(na.action = "na.fail")
library(phytools)
library(picante)
library(raster)
library(VennDiagram)
phylosig(new.tree,new.data$KO_temp_worker.x,method="lambda")
phylosig(new.tree,new.data$KO_temp_worker.x,method="K")
